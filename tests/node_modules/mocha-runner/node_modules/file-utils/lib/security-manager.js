"use strict";var SecurityManager=function(){this._permissions={};var e=(new File(".")).getAbsolutePath();this._permissions[e]=SecurityManager.READ_WRITE};module.exports=SecurityManager;var File=require("./file");SecurityManager.NONE=0,SecurityManager.READ=1,SecurityManager.WRITE=2,SecurityManager.READ_WRITE=3;var getAbsolutePath=function(e){return e instanceof File?e.getAbsolutePath():(new File(e)).getAbsolutePath()};SecurityManager.prototype._getPermissions=function(e){e=getAbsolutePath(e);var t={path:null,perm:null};for(var n in this._permissions){var r=new RegExp("^"+n);e.match(r)&&(!t.path||!t.path.match(r))&&(t.path=n,t.perm=this._permissions[n])}return t.path?t.perm:SecurityManager.READ},SecurityManager.prototype.allow=function(e,t){this._permissions[getAbsolutePath(e)]=t},SecurityManager.prototype.deny=function(e,t){this._permissions[getAbsolutePath(e)]=4+~t};var stringify=function(e){switch(e){case SecurityManager.NONE:return"NONE		";case SecurityManager.READ:return"READ		";case SecurityManager.WRITE:return"WRITE		";case SecurityManager.READ_WRITE:return"READ_WRITE	"}};SecurityManager.prototype.toString=function(){var e="";for(var t in this._permissions)e+=stringify(this._permissions[t])+t+"\n";return e}